# Echo Distiller Configuration v1.0
# Automated codebase distillation system
# ğŸ¯ ëª©í‘œ: 80MB â†’ 12MB while preserving 98% functionality

version: "1.0"
description: "EchoJudgmentSystem_v10 distillation configuration"

# =============================================================================
# ANCHOR ì‹œìŠ¤í…œ - ì ˆëŒ€ ë³´ì¡´í•´ì•¼ í•  í•µì‹¬ íŒŒì¼ë“¤
# =============================================================================
anchor:
  must_keep:
    # ğŸ”¥ í•µì‹¬ íŒë‹¨ ì—”ì§„ (Echo Foundation)
    - "echo_engine/judgment_engine.py"
    - "echo_engine/judgment_loop_generator.py"
    - "echo_engine/reasoning.py"
    - "echo_engine/eight_loop_system.py"
    
    # ğŸ­ ì‹œê·¸ë‹ˆì²˜ ì‹œìŠ¤í…œ (AI Personas) 
    - "echo_engine/signature_mapper.py"
    - "echo_engine/signature_engine.py"
    - "echo_engine/persona_core.py"
    - "echo_engine/signature/signature_registry.py"
    
    # ğŸ’Š ìº¡ìŠ ì‹œìŠ¤í…œ (Knowledge Capsules)
    - "echo_engine/capsule_loader.py"
    - "echo_engine/capsule_simulators.py"
    - "echo_engine/tools/capsule_cli.py"
    - "echo_engine/tools/capsule_auto_router.py"
    - "capsules/aurora_empathy_capsule.py"
    - "capsules/phoenix_transformation_capsule.py"
    
    # ğŸ§  ë©”ëª¨ë¦¬ & í•™ìŠµ ì‹œìŠ¤í…œ
    - "echo_engine/echo_hippocampus.py"
    - "echo_engine/echo_system_memory.py"
    - "echo_engine/adaptive_learning_engine.py"
    - "claude_memory_system.py"
    
    # ğŸŒ API & ì›¹ ì¸í„°í˜ì´ìŠ¤
    - "echo_engine/echo_agent_api.py"
    - "api/main.py"
    - "api/router.py"
    - "streamlit_ui/comprehensive_dashboard.py"
    
    # ğŸ”§ êµ¬ì„± & ì´ˆê¸°í™”
    - "config/echo_system_config.yaml"
    - "config/config_loader.py"
    - "main.py"
    - "echo_foundation_doctrine.py"

  nice_to_have:
    # ğŸ“Š ëŒ€ì‹œë³´ë“œ & ëª¨ë‹ˆí„°ë§
    - "dashboard.py"
    - "echo_unified_dashboard.py"
    - "streamlit_ui/"
    
    # ğŸ› ï¸ ê°œë°œ ë„êµ¬ë“¤
    - "quick_dev.py"
    - "workflow_runner.py"
    - "coding_assistant.py"
    - "tools/"
    
    # ğŸ¤– EchoGPT Teacher-Student ì‹œìŠ¤í…œ
    - "echogpt/"
    
    # ğŸ” IDE í†µí•©
    - "echo_ide/"

# =============================================================================
# SCORING ì‹œìŠ¤í…œ - íŒŒì¼ ì¤‘ìš”ë„ í‰ê°€ ê¸°ì¤€
# =============================================================================
scoring:
  weights:
    # í•µì‹¬ ì‹œìŠ¤í…œ êµ¬ì„±ìš”ì†Œ
    anchor_core: 10        # Anchor must_keep íŒŒì¼ë“¤
    anchor_nice: 7         # Anchor nice_to_have íŒŒì¼ë“¤
    
    # ì½”ë“œ í’ˆì§ˆ ì§€í‘œ  
    test_covered: 5        # í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ì¡´ì¬
    import_centrality: 4   # Import ì¤‘ì•™ì„± (ë§ì´ importë˜ëŠ” íŒŒì¼)
    function_density: 3    # í•¨ìˆ˜ ë°€ë„ (LOC ëŒ€ë¹„ í•¨ìˆ˜ ìˆ˜)
    
    # ì‚¬ìš© íŒ¨í„´
    recent_modified: 3     # ìµœê·¼ ìˆ˜ì •ëœ íŒŒì¼ë“¤
    git_activity: 2        # Git í™œë™ë„
    
    # ì˜ì¡´ì„± ê´€ê³„
    dependency_depth: 2    # ì˜ì¡´ì„± ê¹Šì´
    circular_dependency: -2 # ìˆœí™˜ ì˜ì¡´ì„± (íŒ¨ë„í‹°)
    
    # í¬ê¸° & ë³µì¡ë„
    size_penalty: -1       # íŒŒì¼ í¬ê¸° íŒ¨ë„í‹° (ë„ˆë¬´ í° íŒŒì¼)
    complexity_penalty: -1  # ë³µì¡ë„ íŒ¨ë„í‹°

  thresholds:
    keep_score: 6.0        # ì´ ì ìˆ˜ ì´ìƒì€ ë³´ì¡´
    thin_score: 3.0        # ì´ ì ìˆ˜ ì´ìƒì€ ì¶•ì†Œ ë³´ì¡´
    cut_score: 1.0         # ì´ ì ìˆ˜ ë¯¸ë§Œì€ ì œê±°

# =============================================================================
# FILTER ì‹œìŠ¤í…œ - íŒŒì¼ ìœ í˜•ë³„ ì²˜ë¦¬ ê·œì¹™
# =============================================================================
filters:
  # ìë™ ì œê±° ëŒ€ìƒ
  auto_remove:
    - "**/__pycache__/**"
    - "**/*.pyc"
    - "**/*.pyo" 
    - "**/*.egg-info/**"
    - "**/node_modules/**"
    - "**/.pytest_cache/**"
    - "**/logs/**"
    - "**/tmp/**"
    - "**/temp/**"
    - "**/*_backup*"
    - "**/system_reorganization_backup/**"
    
  # ì••ì¶• ëŒ€ìƒ (ì½”ë©˜íŠ¸/ë…ìŠ¤íŠ¸ë§ ì œê±°)
  compress_targets:
    - "**/*.py"
    - "**/*.js"
    - "**/*.ts"
    
  # í¬ê¸° ê¸°ë°˜ í•„í„°ë§
  size_limits:
    single_file_mb: 5      # 5MB ì´ìƒ íŒŒì¼ì€ ë¶„ì„ ëŒ€ìƒ
    total_directory_mb: 20  # 20MB ì´ìƒ ë””ë ‰í† ë¦¬ëŠ” ì •ë¦¬ ëŒ€ìƒ

# =============================================================================
# 3-PASS PIPELINE ì„¤ì •
# =============================================================================
pipeline:
  # Pass A: MAP - êµ¬ì¡° ë§µí•‘
  map:
    enable_ast_analysis: true      # AST ê¸°ë°˜ êµ¬ì¡° ë¶„ì„
    enable_import_graph: true      # Import ì˜ì¡´ì„± ê·¸ë˜í”„
    enable_execution_trace: false  # ì‹¤í–‰ ì¶”ì  (ë¬´ê±°ì›€, ê¸°ë³¸ ë¹„í™œì„±í™”)
    
  # Pass B: SCORE - ì¤‘ìš”ë„ ì ìˆ˜ ë¶€ì—¬
  score:
    use_git_history: true          # Git íˆìŠ¤í† ë¦¬ ê¸°ë°˜ ì ìˆ˜
    analyze_test_coverage: true    # í…ŒìŠ¤íŠ¸ ì»¤ë²„ë¦¬ì§€ ë¶„ì„
    calculate_centrality: true     # Import ì¤‘ì•™ì„± ê³„ì‚°
    
  # Pass C: CUT & PACK - ì•ˆì „í•œ ì ˆë‹¨ ë° íŒ¨í‚¤ì§•
  cut:
    create_git_branch: true        # ì•ˆì „ì„ ìœ„í•œ Git ë¸Œëœì¹˜ ìƒì„±
    generate_undo_script: true     # ë³µì› ìŠ¤í¬ë¦½íŠ¸ ìƒì„±
    preserve_structure: true       # ë””ë ‰í† ë¦¬ êµ¬ì¡° ë³´ì¡´

# =============================================================================
# ì¶œë ¥ ë””ë ‰í† ë¦¬ êµ¬ì¡°
# =============================================================================
output:
  base_directory: "distilled_echo"
  
  structure:
    keep/: "ë†’ì€ ì ìˆ˜, ì›ë³¸ ê·¸ëŒ€ë¡œ ë³´ì¡´"
    thin/: "ì¤‘ê°„ ì ìˆ˜, ì½”ë©˜íŠ¸ ì œê±°í•˜ì—¬ ì¶•ì†Œ"
    legacy/: "ë‚®ì€ ì ìˆ˜, ì°¸ê³ ìš©ìœ¼ë¡œë§Œ ë³´ì¡´"
    external/: "ì™¸ë¶€ ì˜ì¡´ì„± ë° ë„êµ¬ë“¤"
    
  metadata:
    distill_report: "distillation_report.md"
    score_matrix: "file_scores.json"
    dependency_graph: "dependency_graph.json"
    undo_script: "undo_distillation.sh"

# =============================================================================
# ì•ˆì „ ì„¤ì •
# =============================================================================
safety:
  dry_run_default: true           # ê¸°ë³¸ì ìœ¼ë¡œ dry-run ëª¨ë“œ
  backup_before_cut: true         # ì ˆë‹¨ ì „ ë°±ì—… ìƒì„±
  git_branch_name: "distill-v{version}-{timestamp}"
  
  confirmation_required:
    - "anchor íŒŒì¼ ìˆ˜ì •"
    - "5MB ì´ìƒ íŒŒì¼ ì œê±°"
    - "100ê°œ ì´ìƒ íŒŒì¼ ì œê±°"

# =============================================================================
# ê²€ì¦ ì„¤ì •  
# =============================================================================
validation:
  post_distill_tests:
    - "python -m compileall distilled_echo/"
    - "python -c 'import sys; sys.path.insert(0, \"distilled_echo\"); import echo_engine'"
    - "cd distilled_echo && python main.py --health-check"
    
  success_criteria:
    max_size_mb: 15                # ìµœëŒ€ 15MB
    min_functionality: 0.95        # ìµœì†Œ 95% ê¸°ëŠ¥ ë³´ì¡´
    compile_success: true          # ì»´íŒŒì¼ ì„±ê³µ í•„ìˆ˜

# =============================================================================
# ë¡œê¹… & ë¦¬í¬íŒ…
# =============================================================================
logging:
  level: "INFO"
  file: "logs/distillation.log"
  console_output: true
  
  report_sections:
    - "ìš”ì•½ í†µê³„"
    - "íŒŒì¼ë³„ ì ìˆ˜"
    - "ì˜ì¡´ì„± ë¶„ì„" 
    - "í¬ê¸° ìµœì í™” ê²°ê³¼"
    - "ê¸°ëŠ¥ ë³´ì¡´ ê²€ì¦"
    - "ë‹¤ìŒ ë‹¨ê³„ ì¶”ì²œ"